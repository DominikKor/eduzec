{% extends "base.html" %}
{% load static %}
{% load humanize %}

{% block title %}
    Detail Page
{% endblock %}

{% block static %}
    <script src="{% static 'js/detail.js' %}"></script>
    <script>var csrf_token = '{{ csrf_token }}';</script>
{% endblock %}

{% block extra_nav %}
    <div class='input-group'>
        <button class="btn btn-dark px-3" type="submit">Ask</button>
        <div class="input-group-append">
        <input type="text" name="q" class="form-control" placeholder="Search" />
        <div class="input-group-append">
        <button class="btn btn-dark px-2" type="submit">Search</button>
        </div>
    </div>
{% endblock %}

{% block content %}
<!-- Question mmmm lol-->
<div class='container'>
    <h2 class='my-4'>{{quest.title}}</h2>
    <p>
        <span class='mr-2'>{{quest.add_time|date:'d/m/y'}}</span>
        <text>by</text>
        <a href='#' class='ml-2'>{{quest.user.username}}</a>
    </p>
    <p>
        tags:
        {% for tags in tags %}
        <a href='#' class='badge badge-secondary p-1'>{{tags}}</a>
        {% endfor %}
    </p>
    <hr/>
    <div class='row'>
        <div class='col-1'>
            <div class='upvote'>
                <button type="button" class="cast-vote" vote_type="upvote" vote_to="question" id='{{ quest.id }}'>
                    <span class='text-success'>
                        <i class="fa fa-chevron-up fa-2x"></i>
                    </span>
                </button> 
            </div>
            <div>
                <strong class="quest_votes" id="{{ quest.id }}">{{ quest.votes.count }}</strong><br/>
            </div>
            <div class='downvote mt-2'>
                <button type="button" class="cast-vote" vote_type="downvote" vote_to="question" id='{{ quest.id }}'>
                    <span class='text-danger'>
                        <i class="fa fa-chevron-down fa-2x"></i>
                    </span><br/>
                </button>
            </div>
        </div>
        <div class='col-11'>
            <p class='mt-3'>
                {{quest.detail}}
            </p>
        </div>
        {% for answer, comments in answers_comments %}
        <div class='col-1'>
            <div class='upvote'>
                <button type="button" class="cast-vote" vote_type="upvote" vote_to="answer" id='{{ answer.id }}'>
                    <span class='text-success'>
                        <i class="fa fa-chevron-up fa-2x"></i>
                    </span>
                </button>
            </div>
            <div>
                <strong class="answer_votes" id="{{ answer.id }}">{{ answer.votes.count }}</strong><br/>
            </div>
            <div class='downvote mt-2'>
                <button type="button" class="cast-vote" vote_type="downvote" vote_to="answer" id='{{ answer.id }}'>
                    <span class='text-danger'>
                        <i class="fa fa-chevron-down fa-2x"></i>
                    </span><br/>
                </button>
            </div>
        </div>
        <div class='col-11'>
            <p class='mt-1'>
                {{answer.detail}}
            </p>
            <hr/>
            <p>
                <span class='mr-2'>{{answer.add_time|date:'d/m/y'}}</span>
                <text>by</text>
                <a href='#' class='mr-2'>{{ answer.user }}</a>
                <span>5 comments</span>
            </p>
            {% if user.is_authenticated %}
            <!-- Comment Section Form -->
            <div class='card'>
                <h6 class='card-header'>Comment</h6>
                <div class='card-body'>
                    <textarea class='form-control comment-text' id="{{ answer.id }}"></textarea>
                    <button type='button' data-answer='{{answer.id}}' class='btn btn-dark my-3 save-comment' user="{{ request.user }}">Comment</button>
                </div>
            </div>
            {% endif %}
            <!--Comment Section Start-->
            <div class='comment-wrapper' id="{{ answer.id }}">
                {% for comment in comments %}
                <div class='card'>
                    <div class='card-body'>
                        <p><a href='#'>{{ comment.user }}</a><text> - </text>{{ comment.comment }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}